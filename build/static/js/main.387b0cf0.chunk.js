(this["webpackJsonpreact-messenger"]=this["webpackJsonpreact-messenger"]||[]).push([[0],{51:function(e,t,c){},55:function(e,t,c){},56:function(e,t,c){"use strict";c.r(t);var n=c(5),a=c.n(n),r=c(41),s=c.n(r),i=(c(51),c(24)),l=c(13),j=c(0),o=c(1),u=c(12),b=c(42),d=c(28),O=c(15),x=c(22),h=Object(b.a)({apiKey:"AIzaSyDbX3CWWkUlcp18egJqw-XKZOM460huNLQ",authDomain:"chatty-17768.firebaseapp.com",projectId:"chatty-17768",storageBucket:"chatty-17768.appspot.com",messagingSenderId:"197300896016",appId:"1:197300896016:web:dcbdf4b676a1796bad2595"}),m=Object(d.b)(h),f=Object(O.f)(h),p=Object(x.c)(h),v=c.p+"static/media/profile.a827c8ce.png",g=c(7);function w(e){var t=e.user,c=e.selectUser,a=e.user1,r=e.chat,s=null===t||void 0===t?void 0:t.uid,i=Object(n.useState)(""),l=Object(u.a)(i,2),j=l[0],o=l[1];return Object(n.useEffect)((function(){var e="".concat(a>s?s+a:a+s),t=Object(O.g)(Object(O.d)(f,"lastMssg",e),(function(e){o(e.data())}));return function(){return t()}}),[]),Object(g.jsxs)("div",{className:"user_wrapper ".concat(r.name===t.name&&"selected_user"),onClick:function(){return c(t)},children:[Object(g.jsxs)("div",{className:"user_info",children:[Object(g.jsxs)("div",{className:"user_detail",children:[Object(g.jsx)("img",{src:t.avatar||v,alt:"avatar",className:"avatar"}),Object(g.jsx)("h4",{children:t.name})]}),Object(g.jsx)("div",{className:"user_status ".concat(t.isOnline?"online":"offline")})]}),(null===j||void 0===j?void 0:j.from)!==a?Object(g.jsx)("div",{className:"lastMssgDisplay  ".concat(null!==j&&void 0!==j&&j.unread?"unread":"read","  "),children:null===j||void 0===j?void 0:j.text}):Object(g.jsxs)("div",{className:"lastMssgDisplay",children:[" ",Object(g.jsx)("em",{children:"me: "})," ",null===j||void 0===j?void 0:j.text]}),Object(g.jsx)("hr",{})]})}var y=function(){return Object(g.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",style:{width:"25px",height:"25px",cursor:"pointer",color:"gray"},viewBox:"0 0 20 20",fill:"currentColor",children:Object(g.jsx)("path",{fillRule:"evenodd",d:"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM6.293 6.707a1 1 0 010-1.414l3-3a1 1 0 011.414 0l3 3a1 1 0 01-1.414 1.414L11 5.414V13a1 1 0 11-2 0V5.414L7.707 6.707a1 1 0 01-1.414 0z",clipRule:"evenodd"})})},N=function(e){var t=e.sendMessage;return Object(g.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",onClick:function(){return t()},style:{width:"25px",height:"25px",cursor:"pointer"},fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6",children:Object(g.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 12L3.269 3.126A59.768 59.768 0 0121.485 12 59.77 59.77 0 013.27 20.876L5.999 12zm0 0h7.5"})})};function k(e){var t=e.sendMessage,c=e.text,n=e.setText,a=e.setImg;return Object(g.jsxs)("form",{className:"message_form",children:[Object(g.jsx)("label",{htmlFor:"img",children:Object(g.jsx)(y,{})}),Object(g.jsx)("input",{type:"file",id:"img",accept:"image/*",style:{display:"none"},onChange:function(e){return a(e.target.files[0])}}),Object(g.jsx)("div",{children:Object(g.jsx)("input",{type:"text",placeholder:"Send a message",value:c,onChange:function(e){return n(e.target.value)}})}),Object(g.jsx)("div",{children:Object(g.jsx)(N,{sendMessage:t})})]})}var C=c(43),_=c.n(C);function D(e){var t=e.msg,c=e.user1,a=Object(n.useRef)();return Object(n.useEffect)((function(){!function(){var e;null===(e=a.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})}()}),[t]),Object(g.jsx)("div",{className:"message_wrapper ".concat(t.from===c?"own":""),ref:a,children:Object(g.jsxs)("p",{className:t.from===c?"me":"friend",children:[t.media?Object(g.jsx)("img",{src:t.media,alt:t.text}):null,t.text,Object(g.jsx)("br",{}),Object(g.jsx)("small",{children:Object(g.jsx)(_.a,{fromNow:!0,children:t.createdAt.toDate()})})]})})}function S(){var e=Object(n.useState)([]),t=Object(u.a)(e,2),c=t[0],a=t[1],r=Object(n.useState)(""),s=Object(u.a)(r,2),i=s[0],l=s[1],b=Object(n.useState)(""),d=Object(u.a)(b,2),h=d[0],y=d[1],N=Object(n.useState)(""),C=Object(u.a)(N,2),_=C[0],S=C[1],M=Object(n.useState)([]),A=Object(u.a)(M,2),L=A[0],P=A[1],I=m.currentUser?m.currentUser.uid:null;Object(n.useEffect)((function(){I=m.currentUser.uid;var e=Object(O.c)(f,"users"),t=Object(O.i)(e,Object(O.l)("uid","not-in",[I||null])),c=Object(O.g)(t,(function(e){var t=[];e.forEach((function(e){t.push(e.data())})),a(t)}));return function(){return c()}}),[]),Object(n.useEffect)((function(){var e=i.uid,t=I>e?e+I:I+e;if(0!==i.id){var c=Object(O.c)(f,"message",t,"chat"),n=Object(O.i)(c,Object(O.h)("createdAt","asc")),a=Object(O.g)(n,(function(e){var t=[];e.forEach((function(e){t.push(e.data())})),P(t)}));return function(){return a()}}}),[i]);var U=function(){var e=Object(o.a)(Object(j.a)().mark((function e(t){var c,n;return Object(j.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l(t),c=t.uid,n=I>c?c+I:I+c,e.next=5,Object(O.k)(Object(O.d)(f,"lastMssg",n),{unread:!1});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),E=function(){var e=Object(o.a)(Object(j.a)().mark((function e(){var t,c,n,a,r,s;return Object(j.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=i.uid,c=I>t?t+I:I+t,!_){e.next=11;break}return a=Object(x.d)(p,"images/".concat((new Date).getTime()," - ").concat(_.name," ")),e.next=6,Object(x.e)(a,_);case 6:return r=e.sent,e.next=9,Object(x.b)(Object(x.d)(p,r.ref.fullPath));case 9:s=e.sent,n=s;case 11:return e.next=13,Object(O.b)(Object(O.c)(f,"message",c,"chat"),{text:h,from:I,to:t,createdAt:O.a.fromDate(new Date),media:n||""});case 13:return e.next=15,Object(O.j)(Object(O.d)(f,"lastMssg",c),{text:h,from:I,to:t,createdAt:O.a.fromDate(new Date),media:n||"",unread:!0});case 15:y(""),S("");case 17:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return I?Object(g.jsxs)("div",{className:"home_container",children:[Object(g.jsx)("div",{className:"users_container",style:{margin:"5px"},children:c.map((function(e){return Object(g.jsx)(w,{user:e,user1:I,chat:i,selectUser:U},e.uid)}))}),Object(g.jsx)("div",{className:"messages_container ".concat(i?null:"empty"),children:i?Object(g.jsxs)(g.Fragment,{children:[Object(g.jsxs)("div",{className:"messages_user",style:{backgroundColor:"#f0f2f5"},children:[Object(g.jsx)("span",{children:Object(g.jsx)("img",{src:i.avatar||v,alt:""})}),Object(g.jsx)("span",{children:Object(g.jsx)("h3",{children:i.name})})]}),Object(g.jsxs)("div",{className:"messages",children:[L.length?L.map((function(e,t){return Object(g.jsx)(D,{msg:e,user1:I},t)})):null,Object(g.jsx)(k,{text:h,setText:y,sendMessage:E,img:_,setImg:S})]})]}):Object(g.jsxs)("div",{className:"wp no_conv",children:[Object(g.jsx)("h3",{className:"no_conv",children:" Select a user to start conversation "}),Object(g.jsx)("h2",{children:"Chatty"})]})})]}):null}var M=function(){return Object(g.jsx)("div",{style:{position:"relative"},children:Object(g.jsx)("h2",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)"},children:"Loading..."})})},A=Object(n.createContext)();function L(e){var t=e.children,c=Object(n.useState)(m.currentUser),a=Object(u.a)(c,2),r=a[0],s=a[1],i=Object(n.useState)(!0),l=Object(u.a)(i,2),j=l[0],o=l[1];for(Object(n.useEffect)((function(){setTimeout((function(){o(!1),s(!!m.currentUser)}),1e3)}),[]);j;)return Object(g.jsx)(M,{});return Object(g.jsx)(A.Provider,{value:{online:r,setOnline:s},children:t})}function P(){var e=Object(n.useContext)(A),t=e.online,c=e.setOnline,a=Object(l.o)(),r=function(){var e=Object(o.a)(Object(j.a)().mark((function e(){return Object(j.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(O.k)(Object(O.d)(f,"users",m.currentUser.uid),{isOnline:!1});case 2:return e.next=4,Object(d.d)(m);case 4:c(!1),a("/login");case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(g.jsxs)("nav",{children:[Object(g.jsx)("h2",{children:Object(g.jsx)(i.b,{to:"/",children:"Chatty"})}),Object(g.jsx)("div",{children:t?Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)(i.b,{to:"/profile",children:"Profile"}),Object(g.jsx)(i.b,{to:"/",onClick:r,children:"Log Out"})]}):Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)(i.b,{to:"/register",children:"Register"}),Object(g.jsx)(i.b,{to:"/login",children:"Log In"})]})})]})}var I=c(4),U=c(19);function E(){var e=Object(n.useContext)(A).setOnline,t=Object(l.o)(),c=Object(n.useState)({name:"",email:"",password:"",error:null,loading:!1}),a=Object(u.a)(c,2),r=a[0],s=a[1],i=r.name,b=r.email,x=r.password,h=r.error,p=r.loading,v=function(e){s(Object(U.a)(Object(U.a)({},r),{},Object(I.a)({},e.target.name,e.target.value)))},w=function(){var c=Object(o.a)(Object(j.a)().mark((function c(n){var a;return Object(j.a)().wrap((function(c){for(;;)switch(c.prev=c.next){case 0:if(n.preventDefault(),s(Object(U.a)(Object(U.a)({},r),{},{error:null,loading:!0})),i&&b&&x){c.next=6;break}s(Object(U.a)(Object(U.a)({},r),{},{error:"All fields are mandatory!",loading:!1})),c.next=20;break;case 6:return c.prev=6,c.next=9,Object(d.a)(m,b,x);case 9:return a=c.sent,c.next=12,Object(O.j)(Object(O.d)(f,"users",a.user.uid),{uid:a.user.uid,name:i,email:b,createdAt:O.a.fromDate(new Date),isOnline:!0});case 12:s({name:"",email:"",password:"",error:null,loading:!1}),e(!0),t("/"),c.next=20;break;case 17:c.prev=17,c.t0=c.catch(6),s(Object(U.a)(Object(U.a)({},r),{},{error:c.t0.message,loading:!1}));case 20:case"end":return c.stop()}}),c,null,[[6,17]])})));return function(e){return c.apply(this,arguments)}}();return Object(g.jsxs)("section",{children:[Object(g.jsx)("h3",{children:"Create An Account"}),Object(g.jsxs)("form",{className:"form",onSubmit:w,children:[Object(g.jsxs)("div",{className:"input_container",children:[Object(g.jsx)("label",{htmlFor:"name",children:"Name"}),Object(g.jsx)("input",{type:"text",name:"name",value:i,onChange:v})]}),Object(g.jsxs)("div",{className:"input_container",children:[Object(g.jsx)("label",{htmlFor:"email",children:"E-mail"}),Object(g.jsx)("input",{type:"text",name:"email",value:b,onChange:v})]}),Object(g.jsxs)("div",{className:"input_container",children:[Object(g.jsx)("label",{htmlFor:"password",children:"Password"}),Object(g.jsx)("input",{type:"text",name:"password",value:x,onChange:v})]}),Object(g.jsxs)("div",{className:"btn_container",children:[h?Object(g.jsxs)("p",{className:"error",children:[" ",h]}):Object(g.jsx)("p",{className:"error"}),Object(g.jsx)("button",{className:"btn",disabled:p,children:p?"creating...":"Register"})]})]})]})}function F(){var e=Object(n.useContext)(A).setOnline,t=Object(l.o)(),c=Object(n.useState)({email:"",password:"",error:null,loading:!1}),a=Object(u.a)(c,2),r=a[0],s=a[1],i=r.email,b=r.password,x=r.error,h=r.loading,p=function(e){s(Object(U.a)(Object(U.a)({},r),{},Object(I.a)({},e.target.name,e.target.value)))},v=function(){var c=Object(o.a)(Object(j.a)().mark((function c(n){var a;return Object(j.a)().wrap((function(c){for(;;)switch(c.prev=c.next){case 0:if(n.preventDefault(),s(Object(U.a)(Object(U.a)({},r),{},{error:null,loading:!0})),i&&b){c.next=6;break}s(Object(U.a)(Object(U.a)({},r),{},{error:"All fields are mandatory!",loading:!1})),c.next=21;break;case 6:return c.prev=6,c.next=9,Object(d.c)(m,i,b);case 9:return a=c.sent,c.next=12,Object(O.k)(Object(O.d)(f,"users",a.user.uid),{isOnline:!0});case 12:s({email:"",password:"",error:null,loading:!1}),e(!0),t("/"),c.next=21;break;case 17:c.prev=17,c.t0=c.catch(6),console.log(c.t0.message),s(Object(U.a)(Object(U.a)({},r),{},{error:c.t0.message,loading:!1}));case 21:case"end":return c.stop()}}),c,null,[[6,17]])})));return function(e){return c.apply(this,arguments)}}();return Object(g.jsxs)("section",{children:[Object(g.jsx)("h3",{children:"Log In to your Account"}),Object(g.jsxs)("form",{className:"form",onSubmit:v,children:[Object(g.jsxs)("div",{className:"input_container",children:[Object(g.jsx)("label",{htmlFor:"email",children:"E-mail"}),Object(g.jsx)("input",{type:"text",name:"email",value:i,onChange:p})]}),Object(g.jsxs)("div",{className:"input_container",children:[Object(g.jsx)("label",{htmlFor:"password",children:"Password"}),Object(g.jsx)("input",{type:"text",name:"password",value:b,onChange:p})]}),Object(g.jsxs)("div",{className:"btn_container",children:[x?Object(g.jsxs)("p",{className:"error",children:[" ",x]}):Object(g.jsx)("p",{className:"error"}),Object(g.jsx)("button",{className:"btn",disabled:h,children:h?"Logging in...":"Log In"})]})]})]})}var R=function(){return Object(g.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",style:{width:"25px",height:"25px",cursor:"pointer"},viewBox:"0 0 20 20",fill:"currentColor",children:Object(g.jsx)("path",{fillRule:"evenodd",d:"M4 5a2 2 0 00-2 2v8a2 2 0 002 2h12a2 2 0 002-2V7a2 2 0 00-2-2h-1.586a1 1 0 01-.707-.293l-1.121-1.121A2 2 0 0011.172 3H8.828a2 2 0 00-1.414.586L6.293 4.707A1 1 0 015.586 5H4zm6 9a3 3 0 100-6 3 3 0 000 6z",clipRule:"evenodd"})})},z=function(e){var t=e.deleteImage;return Object(g.jsx)("svg",{onClick:t,xmlns:"http://www.w3.org/2000/svg",style:{width:"25px",height:"25px",cursor:"pointer",color:"#f24957"},viewBox:"0 0 20 20",fill:"currentColor",children:Object(g.jsx)("path",{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z",clipRule:"evenodd"})})};function V(){var e=Object(n.useState)(""),t=Object(u.a)(e,2),c=t[0],a=t[1],r=Object(n.useState)(),s=Object(u.a)(r,2),i=s[0],b=s[1],d=Object(l.o)("");Object(n.useEffect)((function(){if(Object(O.e)(Object(O.d)(f,"users",m.currentUser.uid)).then((function(e){e.exists&&b(e.data())})),c){var e=function(){var e=Object(o.a)(Object(j.a)().mark((function e(){var t,n,r;return Object(j.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=Object(x.d)(p,"avatar/".concat((new Date).getTime()," - ").concat(c.name)),e.prev=1,!i.avatarPath){e.next=5;break}return e.next=5,Object(x.a)(Object(x.d)(p,i.avatarPath));case 5:return e.next=7,Object(x.e)(t,c);case 7:return n=e.sent,e.next=10,Object(x.b)(Object(x.d)(p,n.ref.fullPath));case 10:return r=e.sent,e.next=13,Object(O.k)(Object(O.d)(f,"users",m.currentUser.uid),{avatar:r,avatarPath:n.ref.fullPath});case 13:a(""),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(1),console.log(e.t0.message);case 19:case"end":return e.stop()}}),e,null,[[1,16]])})));return function(){return e.apply(this,arguments)}}();e()}}),[c]);var h=function(){var e=Object(o.a)(Object(j.a)().mark((function e(){return Object(j.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!window.confirm("Delete DP?")){e.next=8;break}return e.next=5,Object(x.a)(Object(x.d)(p,i.avatarPath));case 5:return e.next=7,Object(O.k)(Object(O.d)(f,"users",m.currentUser.uid),{avatar:"",avatarPath:""});case 7:d("/");case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0.message);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}();return i?Object(g.jsx)("div",{className:"profile_background",children:Object(g.jsxs)("section",{className:"profile_container profile_section",children:[Object(g.jsxs)("div",{className:"img_container",children:[Object(g.jsx)("img",{src:i&&i.avatar||v,alt:"DP"}),Object(g.jsx)("div",{className:"overlay",children:Object(g.jsxs)("div",{children:[Object(g.jsx)("label",{htmlFor:"photo",children:Object(g.jsx)(R,{})}),i&&i.avatar?Object(g.jsx)(z,{deleteImage:h}):null,Object(g.jsx)("input",{type:"file",accept:"image/*",id:"photo",style:{display:"none"},onChange:function(e){return a(e.target.files[0])}})]})})]}),Object(g.jsxs)("div",{className:"text_container",children:[Object(g.jsx)("h3",{children:i?i.name:null}),Object(g.jsx)("p",{children:i?i.email:null}),Object(g.jsx)("hr",{}),Object(g.jsxs)("small",{children:["Joined on ",i?i.createdAt.toDate().toDateString():null]})]})]})}):null}c(55);var B=function(){var e=Object(n.useContext)(A).online;return Object(g.jsxs)(i.a,{children:[Object(g.jsx)(P,{}),Object(g.jsxs)(l.d,{children:[Object(g.jsx)(l.b,{exact:!0,path:"/",element:e?Object(g.jsx)(S,{}):Object(g.jsx)(l.a,{replace:!0,to:"/login"})}),Object(g.jsx)(l.b,{exact:!0,path:"/register",element:Object(g.jsx)(E,{})}),Object(g.jsx)(l.b,{exact:!0,path:"/login",element:Object(g.jsx)(F,{})}),Object(g.jsx)(l.b,{exact:!0,path:"/profile",element:e?Object(g.jsx)(V,{}):Object(g.jsx)(l.a,{replace:!0,to:"/login"})})]})]})};s.a.createRoot(document.getElementById("root")).render(Object(g.jsx)(a.a.StrictMode,{children:Object(g.jsx)(L,{children:Object(g.jsx)(B,{})})}))}},[[56,1,2]]]);
//# sourceMappingURL=main.387b0cf0.chunk.js.map